\doxysection{Graphics\+Pipeline.\+h}
\hypertarget{GraphicsPipeline_8h_source}{}\label{GraphicsPipeline_8h_source}\index{GraphicsPipeline.h@{GraphicsPipeline.h}}
\mbox{\hyperlink{GraphicsPipeline_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ GRAPHICS\_PIPELINE\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ GRAPHICS\_PIPELINE\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{comment}{//Config\ and\ main\ helpers/universal\ structs}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config_8h}{Utils/config.h}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cstm__types_8h}{Utils/cstm\_types.h}}"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{comment}{//Vulkan\ Components}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{Swapchain_8h}{Core/Swapchain.h}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{VulkanDevices_8h}{Core/VulkanDevices.h}}"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{comment}{//These\ are\ utility\ classes\ used\ within\ this\ class}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ShaderLoader_8h}{Managers/ShaderLoader.h}}"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{SwapchainRecreater_8h}{Managers/SwapchainRecreater.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{comment}{//Forward\ declarations}}
\DoxyCodeLine{00017\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classDescriptorManager}{DescriptorManager}};\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classMeshManager}{MeshManager}};\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{class\ }DescriptorManaager;\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classBufferManager}{BufferManager}};\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classBuffer}{Buffer}};}
\DoxyCodeLine{00022\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classGUI}{GUI}};\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classMesh}{Mesh}};}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classGraphicsPipeline_ad0b25e77cd9fbb627ec5b4c060b2cc63}{GraphicsPipeline}}\ \{}
\DoxyCodeLine{00026\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{comment}{//\ Constructor}}
\DoxyCodeLine{00028\ \ \ \ \ \mbox{\hyperlink{classGraphicsPipeline_ad0b25e77cd9fbb627ec5b4c060b2cc63}{GraphicsPipeline}}(std::shared\_ptr<VulkanInstance>\ instance,\ }
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ std::shared\_ptr<Devices>\ devices)}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ :\ instance(instance),\ devices(devices)\{}
\DoxyCodeLine{00031\ \ \ \ \ \}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{comment}{//\ Manually\ track\ whether\ window\ has\ been\ resized}}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsPipeline_afd423fe832373306f783bf2952d941de}{framebufferResized}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{comment}{//\ Pipeline\ setup}}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_afd54d09a056a62fe6fbeda996ca5892d}{createGraphicsPipeline}}(std::shared\_ptr<RenderTargeter>\ renderTargeter,\ std::array<VkDescriptorSetLayout,\ 3>\ descriptorSetLayouts);}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_ae0010f99bef827812628784c69ec23c4}{createCommandPool}}();}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_a50491dc07e838c5f8101912156f78226}{createCommandBuffer}}();}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_a4a8d11e10d4a1dc89b7562d5e3ac1e44}{createSyncObjects}}();}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//\ ===\ Main\ frame\ draw\ functions\ ===}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{comment}{//Drawing\ w/\ Swapchain}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_a9006c46bad7130488561e79132f995cc}{drawSwapchain}}(}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ GLFWwindow*\ window,}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsPipeline_afd423fe832373306f783bf2952d941de}{framebufferResized}},}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<DescriptorManager>\&\ descriptorManager,}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<BufferManager>\&\ bufferManager,}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<MeshManager>\&\ meshManager,}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<SwapchainRecreater>\&\ swapchainRecreater,}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<GUI>\&\ gui,}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<RenderTargeter>\&\ renderTargeter}
\DoxyCodeLine{00053\ \ \ \ \ );}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//Drawing\ w/\ full\ offscreen\ target\ set\ up}}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_a4ea9059102b872806b1cca00a560651c}{drawOffscreen}}(}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ GLFWwindow*\ window,}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsPipeline_afd423fe832373306f783bf2952d941de}{framebufferResized}},}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<DescriptorManager>\&\ descriptorManager,}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<BufferManager>\&\ bufferManager,}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<MeshManager>\&\ meshManager,}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<SwapchainRecreater>\&\ swapchainRecreater,}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<GUI>\&\ gui,}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<RenderTargeter>\&\ renderTargeter}
\DoxyCodeLine{00064\ \ \ \ \ );}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//\ REFACTOR\ THIS\ FUNCTION\ INTO\ THE\ ABOVE\ FUNCTIONS,}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{//\ [NOTE]:\ DRAW\ OFFSCREEN\ WILL\ BE\ LARGELY\ INCOMPLETE\ FOR\ NOW}}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_a1f168461c6689e4acae3dd20d60e020b}{drawFrame}}(GLFWwindow*\ window,\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsPipeline_afd423fe832373306f783bf2952d941de}{framebufferResized}},}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ std::shared\_ptr<DescriptorManager>\ descriptorManager,}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ std::shared\_ptr<BufferManager>\ bufferManager,}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ std::shared\_ptr<MeshManager>\ meshManager,}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ std::shared\_ptr<SwapchainRecreater>\ swapchainRecreater,\ }
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ std::shared\_ptr<GUI>\ gui,}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ std::shared\_ptr<RenderTargeter>\ renderTargeter}
\DoxyCodeLine{00075\ \ \ \ \ );}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{//Draw\ with\ ONLY\ swapchain}}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_aeb86c882fa8e7e21dd03564d58081a6f}{recordFullDraw}}(}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ VkCommandBuffer\ commandBuffer,}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ uint32\_t\ imageIndex,}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<DescriptorManager>\&\ descriptorManager,}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<BufferManager>\&\ bufferManager,}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<MeshManager>\&\ meshManager,}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<GUI>\&\ gui,}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<RenderTargeter>\&\ renderTargeter}
\DoxyCodeLine{00086\ \ \ \ \ );}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{//Draw\ with\ offscreen\ target}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_a336dfdb1044e1ebac65f4a9ce4bd4a7c}{recordOffscreenDraw}}(VkCommandBuffer\ commandBuffer,}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ uint32\_t\ imageIndex,}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ std::shared\_ptr<DescriptorManager>\ descriptorManager,}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ std::shared\_ptr<BufferManager>\ bufferManager,}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ std::shared\_ptr<MeshManager>\ meshManager,}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ std::shared\_ptr<GUI>\ gui,}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ std::shared\_ptr<RenderTargeter>\ renderTargeter);}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_a270e23a99c598a06fb10125137a2be9b}{drawMesh}}(}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ VkCommandBuffer\ commandBuffer,}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<BufferManager>\&\ bufferManager,}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ meshName,}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<Mesh>\&\ meshPtr,}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ usePushConstant}
\DoxyCodeLine{00103\ \ \ \ \ );}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{comment}{//\ Cleanup}}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsPipeline_a35737563e8e2f531a0cb4f4208058323}{cleanup}}();}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{comment}{//\ Getters}}
\DoxyCodeLine{00109\ \ \ \ \ VkPipeline\ \mbox{\hyperlink{classGraphicsPipeline_ad272ba605a42eb5380f2003d68702d30}{getGraphicsPipeline}}()\ \{\ \textcolor{keywordflow}{return}\ graphicsPipeline;\ \};}
\DoxyCodeLine{00110\ \ \ \ \ VkPipelineLayout\ \mbox{\hyperlink{classGraphicsPipeline_a354d0860ebcc380170ef20fb0ffbd353}{getPipelineLayout}}()\ \{\ \textcolor{keywordflow}{return}\ pipelineLayout;\ \};}
\DoxyCodeLine{00111\ \ \ \ \ std::vector<VkCommandBuffer>\ \mbox{\hyperlink{classGraphicsPipeline_acf74df7260bd6fd9e5e1b9259bf56cc9}{getCommandBuffers}}()\ \{\ \textcolor{keywordflow}{return}\ commandBuffers;\ \};}
\DoxyCodeLine{00112\ \ \ \ \ VkCommandPool\ \mbox{\hyperlink{classGraphicsPipeline_ad9ae135165778c8b41b9c55bc8dbbfe2}{getCommandPool}}()\ \{\ \textcolor{keywordflow}{return}\ commandPool;\ \};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{classGraphicsPipeline_a95368133b2eba03b330b0b1da5571b6d}{getCurrentFrame}}()\ \{\ \textcolor{keywordflow}{return}\ currentFrame;\ \};}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{comment}{//\ Injected\ vulkan\ core\ component\ classes}}
\DoxyCodeLine{00118\ \ \ \ \ std::shared\_ptr<Devices>\ devices\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00119\ \ \ \ \ std::shared\_ptr<RenderTargeter>\ renderTargeter\ =\ \textcolor{keyword}{nullptr};\ }
\DoxyCodeLine{00120\ \ \ \ \ std::shared\_ptr<VulkanInstance>\ instance\ =\ \textcolor{keyword}{nullptr};\ }
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{comment}{//Injected\ resource\ managers}}
\DoxyCodeLine{00123\ \ \ \ \ std::shared\_ptr<DescriptorManager>\ descriptorManager;}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ uint32\_t\ currentFrame\ =\ 0;}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{comment}{//\ Graphics\ Pipeline}}
\DoxyCodeLine{00128\ \ \ \ \ VkPipelineLayout\ pipelineLayout;}
\DoxyCodeLine{00129\ \ \ \ \ VkPipeline\ graphicsPipeline;}
\DoxyCodeLine{00130\ \ \ \ \ std::shared\_ptr<ShaderLoader>\ shaderLoader;}
\DoxyCodeLine{00131\ \ \ \ \ std::vector<VkDynamicState>\ dynamicStates\ =\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ VK\_DYNAMIC\_STATE\_VIEWPORT,}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ VK\_DYNAMIC\_STATE\_SCISSOR}
\DoxyCodeLine{00134\ \ \ \ \ \};}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{comment}{//\ Command\ system}}
\DoxyCodeLine{00137\ \ \ \ \ VkCommandPool\ commandPool;}
\DoxyCodeLine{00138\ \ \ \ \ std::vector<VkCommandBuffer>\ commandBuffers;}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{comment}{//\ Sync\ objects}}
\DoxyCodeLine{00141\ \ \ \ \ std::vector<VkSemaphore>\ imageAvailableSemaphores;}
\DoxyCodeLine{00142\ \ \ \ \ std::vector<VkSemaphore>\ renderFinishedSemaphores;}
\DoxyCodeLine{00143\ \ \ \ \ std::vector<VkFence>\ inFlightFences;}
\DoxyCodeLine{00144\ \};}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
